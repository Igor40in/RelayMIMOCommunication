clc
clear all
vecSNIR = 0:2.5:20;
nSNIR = length(vecSNIR);
% K = [1.38000000000000;2;2.11000000000000;2.89000000000000;3.05000000000000;3.72666666666667;3.98666666666667;4.02333333333333;4.24333333333333];
% K = [2.80066666666667;3.01400000000000;3.47466666666667;3.97266666666667;4.01833333333333;4.20166666666667;4.55966666666667;4.84000000000000;4.95633333333333];
% K = [3.03000000000000;3.47000000000000;3.94333333333333;4.05000000000000;4.28333333333333;4.58666666666667;4.83666666666667;4.93000000000000;4.98666666666667];
% K = [2;2.13333333333333;2.84333333333333;3.09000000000000;3.59333333333333;3.98000000000000;4.08000000000000;4.38000000000000;4.65666666666667];
K = [4.14333333333333;5.54666666666667;7.57333333333333;8.43000000000000;10.9933333333333;12.4333333333333;15.0500000000000;18.6200000000000;19.7200000000000];
nRelayStation = 2;
P = 10.^(vecSNIR'/10);
% P = P./20;
x = P./K;
da = 0.0001;
a = da:da:4;
Fa = 1/(2*pi)*sqrt((4-a)./a);
L = nRelayStation+1;
x = P./20;
for iSNIR=1:nSNIR
%     AMSE(iSNIR) = sum((1-(1+a.^(-1).*x(iSNIR)^(-1)).^(-L)).*Fa)*da*K(iSNIR);
        AMSE(iSNIR) = sum( (1-(1+1./(a.*x(iSNIR))).^(-L)).*Fa )*da;
    1;
end
plot(vecSNIR,AMSE)
grid on

return
da = 0.0001;
a = da:da:4;
Fa = 1/(2*pi)*sqrt((4-a)./a);
x = 0:0.1:50;
L = 2;
for i=1:length(x)
    AMSE(i) = sum( (1-(1+1./(a.*x(i))).^(-L)).*Fa )*da;
end
plot(x,AMSE);grid on;xlabel('x');ylabel('Normaliz AMSE')